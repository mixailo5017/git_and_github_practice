window.fd={logging:!1},$(function(){"use strict";function e(){return"draggable"in document.createElement("span")}function o(){setTimeout(function(){var e=$(".cropper-container").height()+60;$(".crop-here").css({height:e})},500)}function r(e){$(".error-head").html(e)}function t(e){"error"===e.status&&r(e.error),"success"===e.status&&(window.location="/signup/confirm")}function n(e){$("#zone").removeClass("fd-zone"),$("#zone").removeClass("filedrop"),$(".fd-file, .drop-meta").hide(),$(".crop-controls, .crop-confirm").show(),l.attr("src",e).cropper({zoomable:!1,modal:!0,aspectRatio:1}),setTimeout(function(){var e=$(".cropper-container").height();$(".crop-wrap").css({height:e})},1e3)}function i(){var e=$("#cropper_image"),o=$(".crop-wrap");e.length&&(o.css({opacity:0}),u=$("#cropper_image").attr("src").replace("/images/signup/",""),$().hide(),$(".drop-meta").hide(),setTimeout(function(){$(".fd-file").hide(),o.animate({opacity:1},500)},500),n(e.attr("src")))}function a(){$("#basicUpload").show(),i()}function s(){$.post(f,{}).success(function(){window.location.reload()}).fail(function(){r("ohh no!")})}function c(e,o){if(!m){m=!0;var n={"fd-file":o,"raw-file":e};$.post(p,n).success(function(e){t(e),m=!1}).fail(function(){h.removeClass("disabled"),r("There was an error saving the image."),m=!1})}}function d(){$("#zone").show();var e={iframe:!1};g=new FileDrop("zone",e),g.event("send",function(e){e.each(function(e){r("");var o=Number(e.size/1024),t=Number(o/1024*100/100),i=e.name,a=i.replace(/^.*\./,"").toLowerCase();"png"!==a&&"jpg"!==a&&"gif"!==a?r("Error: File must be a 'jpg', 'png', or 'gif'"):t>5?r("Error: Upload file must be less than 5 MB"):($(".fd-file").hide(),$(".progress").fadeIn("fast"),e.event("progress",function(e,o){var r=e/o*100+"%";window.fd.byID("bar_zone").style.width=r}),e.event("done",function(e){$(".progress").fadeOut("fast",function(){var o=jQuery.parseJSON(e.responseText);return"undefined"!=typeof o.status&&"success"===o.status?void n(o.original):"undefined"!=typeof o.status&&"error"===o.status?(r("Error: "+o.error),void $(".fd-file").show()):(r("Error: File could not be uploaded"),void $(".fd-file").show())})}),e.sendTo(p)),e.event("error",function(){r("Error uploading "+this.name),$(".fd-file").show()})})})}var p="/signup/photo/upload",f="/signup/photo/remove",u="",l=$(".crop-wrap > img"),h=$(".crop-zone"),g=null,m=!1;h.on("click","[data-method]",function(){var e=$(this),r=e.data(),t=e.attr("id");if(h.hasClass("disabled"))return!1;if(r.method&&(l.cropper(r.method,r.option),"rotate"===r.method&&o()),"saveImage"===t){var n=$(".cropper-container").height()/2;$(".progress").fadeIn("fast").prepend("Saving image please wait.").css({top:n}).children().css({width:"100%"}),h.addClass("disabled"),c(l.cropper("getDataURL"),u)}"removeImage"===t&&(h.addClass("disabled"),s())}),$("#rotateLeft").tipsy({gravity:"s"}),$("#rotateRight").tipsy({gravity:"s"}),$("html").hasClass("ie9")&&$('#basicUpload input[type="file"]').on("change",function(){$("#upload_photo").fadeIn()}),i(),e()?d():a()});